Міністерство освіти і науки України
Харківський національний університет радіоелектроніки

Катедра програмної інженерії



ЗВІТ
до практичного завдання № 1
з дисципліни «Аналіз та рефакторинґ коду»
на тему: «Правила оформлення програмного коду C# за стандартами Microsoft C# Coding Conventions»



     Виконала
     ст. гр. ПЗПІ-23-8
     Бут Анна

     Перевірив
     ст. викладач катедри ПІ
     Сокорчук Ігор Петрович





Харків, 2025 р.
1 ІСТОРІЯ ЗМІН

№ДатаВерсія звітуОпис змін та виправлень101.11.20250.1Створено розділ «Завдання»  203.11.20250.1Створено розділ «Опис виконаної роботи»305.11.20250.1Створено розділи «Висновки» та «Використані джерела»409.11.20250.1Створено додатки  «А» та «Б»      
     
     
     
     
     
     
     
     
     
     
     
     
     
     


     2 ЗАВДАННЯ

     Обрати мову програмування, дослідити основні рекомендації для написання якісного коду у цій мові, продемонструвати ці рекомендації на прикладах коду, обґрунтувати кожну рекомендацію і надати детальні пояснення. Для кожного прикладу навести фрагменти коду.
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     

     3 ОПИС ВИКОНАНОЇ РОБОТИ
     3.1 Вступ
     
     C# – це сучасна об'єктно-орієнтована мова програмування від Microsoft, яка працює на платформі .NET. Вона є кросплатформною, що дозволяє створювати застосунки для різних операційних систем, зокрема Windows, Linux та macOS. Завдяки цьому C# широко використовується для створення веб- і мобільних застосунків, ігор (зокрема в середовищі Unity).
     Мова C# має знайомий і зрозумілий синтаксис для розробників, які вже працювали з C, C++ та Java, оскільки вона використовує подібні синтаксичні конструкції.
     
     3.2 Важливість правил оформлення коду
     
     Щоб код був зрозумілим, структурованим і легким у підтримці, важливо дотримуватись єдиних стандартів його оформлення.
     Компанія Microsoft розробила C# Coding Conventions – набір правил і рекомендацій, які визначають, як саме слід писати, форматувати та оформлювати програмний код. Ці угоди створені на основі кількох ключових цілей: правильність програм, узгодженість стилю - єдиний підхід у всіх рішеннях, навчальну цінність зразків коду і швидке впровадження нових можливостей мови.
     
     3.3 Структура коду
     
     Програми на C# зазвичай складаються з одного або кількох вихідних файлів з розширенням .cs. Кожен файл може містити один або кілька просторів імен, а простір імен об’єднує типи, такі як класи, структури, інтерфейси, делегати та перерахування. Для підтримки чистоти та зручності коду кожен клас, структура чи інтерфейс зазвичай зберігається в окремому файлі. Назва файлу повинна відповідати назві основного класу або типу, що він містить. 
     Структура директорій у C# проєкті зазвичай відображає функціональні модулі або шари програми. Ієрархія папок повинна відповідати структурі просторів імен для зручної навігації та зрозумілої логіки проєкту.
     Принципи логічного поділу коду передбачають, що кожен модуль виконує одну конкретну функцію або групу функцій, а класи відповідають одній сутності або концепції, що дозволяє дотримуватися принципу єдиної відповідальності (Single Responsibility Principle). 
     
1 // Приклад поганого коду.
2 namespace CityGuide
3 {
4     public class WeatherForecast
5     {
6     }
7     public class MapHelper
8     {
9     }
10 }
11 
12 // Приклад хорошого коду.
13  namespace CityGuide.Models
14  {
15     public class WeatherForecast
16     {
17         public string City { get; set; }
18         public string Summary { get; set; }
19         public int TemperatureC { get; set; }
20     }
21  }

     3.4 Форматування коду

     При написанні коду на C# дуже важливо дотримуватися стандартів стилю, щоб зробити його зрозумілим, структурованим і легким для підтримки. Основні рекомендації з форматування коду:
* відступи виконуються за допомогою чотирьох пробілів без застосування табуляції, оскільки пробіли забезпечують однакове відображення коду в різних редакторах і системах;
* код вирівнюється послідовно, особливо вкладені блоки, для покращення читабельності;
* довжина рядків обмежується приблизно 65 символами, щоб код було зручно переглядати;
* довгі оператори та виклики методів слід розбивати на кілька рядків, зберігаючи логічну структуру та відступи;
* фігурні дужки оформлюються відповідно до стилю Allman: відкриваюча і закриваюча дужки розміщуються на окремих рядках та вирівнюються за рівнем відступу;
* кожне твердження або оголошення розміщується в окремому рядку;
* потрібно залишати принаймні один рядок для візуального розділення елементів класу.

1 //Приклад поганого коду.
2 class Calculator{
3     public int Add(int a, int b){
4         int result = a + b;
5         Console.WriteLine("Result:" + result);
6         return result;}}
7 
8 //Приклад хорошого коду.
9 public class Calculator
10 {
11     public int Add(int a, int b)
12     {
13         int result = a + b;
14         Console.WriteLine($"Result: {result}");
15         return result;
16     }
17 }

     3.5 Іменування (іменування змінних, функцій, класів)
     
     Вибір імен повинен базуватися на зрозумілості та лаконічності. Ім’я має відображати роль змінної, методу або класу, а ясність завжди важливіша за стислість. Не слід використовувати однолітерні змінні, за винятком простих лічильників циклів (i, j, k).
     Для іменування типів, класів, структур, інтерфейсів, методів та загальнодоступних елементів застосовується стиль PascalCase. Імена інтерфейсів починаються з літери I (IRepository), типи атрибутів закінчуються словом Attribute (SerializableAttribute). Для параметрів методів та локальних змінних використовується стиль camelCase.
     Поля приватного екземпляра зазвичай починаються з підкреслення _ і оформлюються у camelCase, наприклад _totalCount. Статичні поля можуть мати префікс s_, наприклад s_instance. Константи іменуються за допомогою PascalCase як для полів класу, так і для локальних констант. 
     Важливо також уникати «магічних чисел» у коді. Числові значення не слід використовувати без пояснення, натомість рекомендується створювати константи або передавати параметри з описовими іменами. 
     
1 //Приклад поганого коду.
2 public int cs(int[] n)
3 {
4     int t = 0;
5     foreach (int x in n)
6     {
7         t += x;
8     }
9     return t;
10 }
11 
12 //Приклад хорошого коду.
13 public int CalculateSum(int[] numbers)
14 {
15     int totalSum = 0;
16     foreach (int number in numbers)
17     {
18         totalSum += number;
19     }
20     return totalSum;
21 }
     
     3.6 Коментарі
     
     Коментарі в C# використовуються для пояснення коду, логіки та документування, але їх слід застосовувати обдумано, щоб не перевантажувати код зайвою інформацією. 
     Існують три основні типи коментарів у C#:
* однорядкові коментарі (//) використовуються для коротких пояснень або позначок у коді. Рекомендовано розміщувати їх на окремому рядку перед тим кодом, до якого вони належать, а не в кінці рядка. Текст коментаря слід починати з великої літери, закінчувати крапкою і вставляти один пробіл після //;
* багаторядкові коментарі (/* */) використовуються для тимчасового вимкнення коду або довших пояснень, але їх слід уникати для постійних довгих коментарів, оскільки вони знижують читабельність коду. 
*  XML-коментарі (///), які дозволяють генерувати документацію. XML-коментарі слід розміщувати безпосередньо перед оголошенням елемента.
     Варто розрізняти коментарі, що пояснюють код, і коментарі, що пояснюють логіку програми. Коментарі для коду пояснюють конкретні інструкції або змінні, тоді як коментарі для логіки описують загальний алгоритм або призначення блоку коду.
     
1 bool IsPrime(int x) //перевірка числа
2 {
3     if (x <= 1) return false;
4 
5     for (int i = 2; i * i <= x; i++)
6     {
7         if (x % i == 0)
8             return false;
9     }
10 
11     return true;
12 }
13 
14 // Повертає true, якщо число просте, а інакше false.
15 bool IsPrime(int n)
16 {
17     if (n <= 1) return false;
18 
19     for (int i = 2; i * i <= n; i++)
20     {
21         if (n % i == 0)
22             return false;
23     }
24 
25     return true;
26 }

     3.7 Документування коду
     
     Документування коду є важливим аспектом розробки програм на C#, оскільки дозволяє створювати структуровані коментарі, на основі яких автоматично формується API-документація. Компілятор C# об’єднує код і коментарі в XML-файл, який може бути оброблений спеціальними інструментами, такими як DocFX, Sandcastle або Doxygen, для створення документації у зручних форматах.
     Існують різні формати XML-коментарів: однорядковий формат ///, який автоматично вставляє Visual Studio та багаторядкові формати /** ... */, де кожен рядок може починатися із зірочки * для покращення читабельності. Важливо дотримуватися єдиного шаблону відступів і пробілів, щоб компілятор правильно обробляв коментарі.
     Для ефективного документування рекомендується використовувати такі теги:
* <summary> –  короткий опис елемента, відображається в IntelliSense.
* <remarks> –  додаткові зауваження до елемента.
* <param> –  опис параметра методу.
* <paramref> — посилання на параметр.
* <returns> –  опис значення, яке повертає метод.
* <exception> –  опис можливих винятків.
* <value> –  опис значення властивості.
* <example> –  приклади використання.
* <typeparam> – опис універсального типу.
* <typeparamref> –  посилання на універсальний параметр.
* <see> та <seealso> –  створюють посилання на інші елементи коду або документації.
* <inheritdoc> та <include> –  повторне використання тексту документації.
* <para>, <list>, <c>, <code>, <b>, <i>, <u>, <br/>, <a> –  теги форматування та створення гіперпосилань.
     Документування коду в C# забезпечує кілька ключових переваг: компілятор перевіряє правильність тегів і параметрів, засоби обробки XML можуть створювати зрозумілу користувачу документацію.

1 // Документування коду.
2 namespace TemperatureConversion
3 {
4     /// <summary>
5     /// The <c>Temperature</c> class provides functions for converting 
6     /// temperature values between different scales.
7     /// </summary>
8     public class Temperature
9     {
10         /// <summary>
11         /// Converts degrees Celsius to degrees Fahrenheit.
12         /// </summary>
13         /// <param name="degreesCelsius">Temperature in degrees Celsius.</param>
14         /// <returns>Returns the temperature in degrees Fahrenheit.</returns>
15         public static int CelsiusToFahrenheit(int degreesCelsius)
16         {
17             return (int)((9.0 / 5.0) * degreesCelsius + 32);
18         }
19 
20         /// <summary>
21         /// Converts degrees Fahrenheit to degrees Celsius.
22         /// </summary>
23         /// <param name="degreesFahrenheit">Temperature in degrees Fahrenheit.</param>
24         /// <returns>Returns the temperature in degrees Celsius.</returns>
25         public static int FahrenheitToCelsius(int degreesFahrenheit)
26         {
27             return (int)((5.0 / 9.0) * (degreesFahrenheit - 32));
28         }
29     }
30 }

     3.8 Кодування на основі тестування (Test-Driven Development)
     
     Кодування на основі тестування, або Test-Driven Development (TDD), передбачає написання тестів перед створенням основного коду. Це дозволяє організувати код так, щоб він був більш підтримуваним і менше схильним до помилок. 
     Для роботи з TDD у C# часто використовують Test Explorer у Visual Studio і фреймворк MSTest, хоча підхід легко адаптується під NUnit або xUnit. Спочатку створюється тест, що перевіряє результат для конкретного вводу. Потім за допомогою Visual Studio можна згенерувати заглушку методу чи класу, яку реалізують так, щоб тест пройшов.
     Наступним кроком є розширення тестів на більший діапазон вхідних даних і додавання перевірок на виняткові ситуації, наприклад негативні числа. Реалізація методу змінюється, доки всі тести не проходять.

     3.9 Інструменти та автоматизація для підтримки якості коду
     
     Статичний аналіз коду допомагає виявляти помилки, потенційні проблеми та невідповідності стилю до того, як програма буде запущена. Для C# популярними інструментами є .NET Compiler Platform (Roslyn) –  платформа з відкритим кодом, що містить компілятори та засоби для аналізу, StyleCop, FxCop, NDepend, Parasoft dotTEST, а також сторонні інструменти, як Codelt.Right і CodeRush. 
     Форматування та автоматизація дозволяють стандартизувати стиль коду та уникнути помилок ще на етапі розробки. Наприклад, Git Hooks автоматично виконують перевірки перед комітом або пушем, а CI/CD (Continuous Integration/Continuous Deployment) забезпечує автоматичне тестування, збірку та аналіз коду на кожному етапі розробки.
     Ще одним важливим напрямком є автоматичні перевірки стилю коду. Для цього використовуються такі засоби, як EditorConfig, який задає стандартизовані правила форматування, а також ReSharper чи JetBrains Rider, що надають автоматичне форматування, рефакторинг і підказки щодо стилю коду. 
     
     3.11 Приклад оформлення коду та його аналіз 
     
     У наведеному прикладі поганого коду порушено правила іменування, порушено стандарти іменування, зокрема назва класу program написана з малої літери, а змінні мають нелогічні назви, що ускладнює розуміння їх призначення. Також код оформлено без дотримання відступів і єдиної структури, фігурні дужки розміщені непослідовно. Після виконання рефакторингу код стає більш зрозумілим. Назва класу змінена на інформативну та оформлена відповідно до стандарту PascalCase, а назви змінних чітко відображають їхнє призначення. Форматування коду приведено у відповідність до загальноприйнятих правил: використано коректні відступи, логічно вирівняні блоки та послідовне розміщення дужок відповідно до стилю Allman.
     
      1 //Приклад поганого коду.
      2 class program
      3 {
      4 static void Main()
      5 {
      6 List<string> n = new List<string> { "Taras", "Olha" };
      7 var messageBuilder = new StringBuilder();
      8 string msg = "";
      9 for (int i = 0; i < n.Count; i++)
      10 {
      11 messageBuilder.AppendLine($"{i + 1}) {n[i]}");
      12 }
      13 Console.WriteLine("Список імен:\n" + msg);
      14 }
      15 }
      16 //Приклад хорошого коду.
      17 public class NameConcatenator
      18 {
      19 public static void Main()
      20 {
      21 var names = new List<string> { "Taras", "Olha" };
      22 var messageBuilder = new StringBuilder();
      23 for (int i = 0; i < names.Count; i++)
      24 {
      25 messageBuilder.AppendLine($"{i + 1}) {names[i]}");
      26 }
      27 Console.WriteLine("Список імен:\n" + messageBuilder);
      28 }
      29 }
      
      
      
      
      

     ВИСНОВКИ
     
     У ході виконаної роботи було розглянуто основні принципи та стандарти оформлення коду на мові C#, зокрема правила іменування змінних, методів і класів, вимоги до форматування коду, а також використання коментарів і засобів документування. Окрему увагу приділено практичним аспектам розробки, зокрема підходу розробки на основі тестування (TDD), застосуванню інструментів автоматизації та статичного аналізу для забезпечення якості програмного коду.
     У результаті отримано навички організації структурованого та зрозумілого коду, дотримання єдиних стандартів програмування, що забезпечує підвищення надійності, читабельності та підтримуваності програмних проєктів.
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     
     


     ВИКОРИСТАНІ ДЖЕРЕЛА
     
     1. .NET Coding Conventions - C#. Microsoft Learn: Build skills that open doors in your career. URL: https://learn.microsoft.com/en-us/dotnet/csharp/fundamentals/coding-style/coding-conventions (дата звернення: 05.11.2025).
     2. Visual Studio documentation. Microsoft Learn: Build skills that open doors in your career. URL: https://learn.microsoft.com/en-us/visualstudio/windows/?view=vs-2022 (дата звернення: 05.11.2025).
     3. Codacy. 3 popular C# style guides that will help improve your coding standards. Codacy | Blog - Automate your code quality. URL: https://blog.codacy.com/3-popular-csharp-style-guides (дата звернення: 05.11.2025).





















ДОДАТОК А
Відеозапис

     Відеозапис доповіді: https://youtu.be/5gmureHOKFM
     Хронологічний опис відеозапису: 
     00:00 – Вступ
     00:47 – Важливість правил оформлення коду
     01:15 – Структура коду 
     02:32 – Форматування коду 
     04:04 – Іменування 
     05:18 – Коментарі 
     06:45 – Документування коду 
     07:44 – Кодування на основі тестування 
     08:32 – Інструменти та автоматизація для підтримки якості коду 
     09:28 – Приклад оформлення коду 
     10:16 – Висновки 
     10:50 – Використані джерела














ДОДАТОК Б
Слайди презентації


Рисунок Б.1 – Титульний слайд


Рисунок Б.2 – Вступ



Рисунок Б.3 – Огляд важливості правил оформлення коду


Рисунок Б.4 – Огляд структури коду





Рисунок Б.5 – Правила форматування коду


Рисунок Б.6 – Іменування (іменування змінних, функцій, класів)






Рисунок Б.7 – Правила використання коментарів


Рисунок Б.8 – Документування коду






Рисунок Б.9 – Кодування на основі тестування


Рисунок Б.10 – Огляд інструментів та автоматизації для підтримки якості коду






Рисунок Б.11 – Аналіз прикладу оформлення коду


Рисунок Б.12 – Висновки






Рисунок Б.13 — Використані джерела

